# 项目2：洛伦兹方程与确定性混沌 - 实验报告

**学生姓名：** [刘涛]  
**学号：** [20231050159]  
**完成日期：** [2025.5.28]  
**实验时间：** [10：30~12：10]

---

## 1. 实验目的

### 1.1 主要目标
- [ ] 掌握洛伦兹方程组的数值求解方法
- [ ] 理解确定性混沌的基本概念和特征
- [ ] 分析洛伦兹吸引子的几何结构
- [ ] 研究系统对初始条件的敏感依赖性（蝴蝶效应）

### 1.2 学习要点
- 洛伦兹方程的物理背景和数学形式
- 混沌系统的基本特征
- 奇异吸引子的可视化方法
- 数值积分方法在混沌系统中的应用

---

## 2. 理论背景

### 2.1 洛伦兹方程组

**方程形式：**
dx/dt = σ(y - x)
dy/dt = rx - y - xz  
dz/dt = xy - bz


**标准参数：**
- σ = 10.0
- r = 28.0
- b = 8/3

**初始条件：**
- 基准条件：(0.1, 0.1, 0.1)
- 扰动条件：(0.10001, 0.1, 0.1)

---

## 3. 实验内容与结果

### 3.1 洛伦兹吸引子可视化

**实现方法：**
- 使用`scipy.integrate.solve_ivp`的RK45方法求解
- 时间范围：t ∈ [0, 50]
- 时间步长：dt = 0.01

**3D轨迹图：**

![Figure_1](https://github.com/user-attachments/assets/4b648b8c-3781-4e8f-8fc5-1dc9386d53d2)

**观察结果：**
- 描述吸引子的形状特征
- 分析轨道的分布特点

1. 整体形状特征

"蝴蝶"对称结构：轨迹在三维空间中形成两个近似环状的"翅膀"，分别位于坐标系的左右两侧（x>0和x<0区域），通过中心区域的不稳定轨道连接，整体呈现类似蝴蝶翅膀的对称形态。

分形结构：近距离观察可发现，每个"翅膀"并非简单曲面，而是由无限多层、紧密缠绕的轨道构成，具有自相似性（放大局部会看到与整体相似的缠绕模式）。

非周期性：轨道永不重复或闭合，始终在两个"翅膀"之间不规则跳跃，但始终被约束在有限空间内（吸引子性质）。

2. 轨道分布特点

螺旋发散与收缩：在"翅膀"边缘，轨道呈螺旋状向外扩展（发散）；接近中心时，轨道又快速收缩并跃迁到另一侧"翅膀"（如"蝴蝶"身体的中心部分）。这种发散-收缩的交替过程体现了鞍点不稳定性。

非均匀密度分布：轨道在"翅膀"边缘处分布较密集（停留时间较长）；中心过渡区域轨道稀疏（快速通过）。

排斥与吸引的平衡：系统整体表现为耗散系统（相空间体积收缩），但局部轨道又因混沌特性而指数发散（Lyapunov指数为正），形成奇异吸引子。

### 3.2 初始条件敏感性分析

**比较结果：**
![Figure_2](https://github.com/user-attachments/assets/30fb8e78-e7ba-4ec9-a1b2-ddb5ca71afc3)


**轨道距离演化：**
![Figure_3](https://github.com/user-attachments/assets/a9468613-3450-4bb2-8480-86b7f9750145)


**分析：**
- 两条轨迹何时开始显著分离
- 分离速率与混沌特性的关系

1. 两条轨迹何时开始显著分离？

初始微小差异：在任务C中，初始条件仅相差 Δx_0=0.00001，但经过一定时间后，两条轨迹 x(t) 和 x′(t) 开始明显偏离。

分离时间点：

早期阶段（t < 5）：两条轨迹几乎重合，差异极小（数值误差级别）。

中期阶段（5 < t < 15）：轨迹开始出现可见偏差，但整体趋势仍相似。

后期阶段（t > 15）：轨迹完全分道扬镳，表现出截然不同的振荡模式（如一个在左"翅膀"，另一个在右"翅膀"）。

关键分离时刻：通常在前 10-15 个时间单位 内，系统对初始条件的敏感性导致轨迹显著分离。

2. 分离速率与混沌特性的关系

指数分离（Lyapunov 指数）：混沌系统的核心特征是相邻轨迹以指数速率分离，即： distance(t)≈distance(0)*e^(λt) ，其中 λ 为 最大 Lyapunov 指数（对洛伦兹系统，λ≈0.9）。

速度-距离图的表现：在双对数坐标下，距离随时间的变化曲线初期呈线性增长（对数尺度），验证了指数分离特性。

分离速率的物理意义：分离速率 λ>0 是混沌系统的数学定义，表明系统具有初值敏感性。分离速率也决定了系统的可预测时间。

饱和现象：当距离达到吸引子尺度（如"翅膀"间距）时，分离停止增长（因系统耗散性约束），此时速度-距离图曲线趋于平缓。

---

## 4. 讨论与结论

### 4.1 主要发现
- 总结洛伦兹系统的混沌特性
- 分析数值方法的适用性

1.洛伦兹系统作为混沌动力学的经典模型，具有以下核心特性：

(1). 确定性混沌：

简单方程，复杂行为：仅由3个非线性微分方程构成，却能产生高度复杂的非周期轨迹。

长期不可预测性：即使方程完全确定，初始条件的微小误差会导致指数级发散（"蝴蝶效应"）。

(2). 初值敏感性

Lyapunov指数为正（λ≈0.9）：相邻轨迹以 e^(λt) 速率分离，系统记忆初始状态的时间有限。

数值体现：任务C中 Δx_0 =10^(−5) 的差异，约15个时间单位后轨迹完全无关。

(3). 奇异吸引子

几何特征：三维相空间中无限折叠的"蝴蝶"结构，具有分形维数（非整数维度）。

耗散性与约束：相空间体积收缩（耗散系统），但轨道永不重复或稳定。

(4). 混合性与遍历性

轨道会覆盖吸引子所有区域，但无周期性。时间平均与空间平均等价。

2.混沌系统的数值求解需平衡精度与计算效率，关键考量如下：

(1). 关键参数

容差设置（rtol, atol）：混沌系统需严格容差（如 rtol=1e-6），否则数值误差会被指数放大。过松的容差导致虚假稳态或轨迹偏离。

步长控制：自适应步长优于固定步长（如RK45自动调整步长应对快速变化的混沌区域）。

(2). 混沌系统的特殊挑战

误差积累：正Lyapunov指数使数值误差快速累积，需高精度算法。

长期模拟失效：即使最优方法也无法精确预测长期行为（本质限制）。

### 4.2 实验心得

1. 对混沌理论的理解深化

确定性≠可预测性：即使方程组完全确定（无随机项），初始条件的微小差异（如 Δx_0=10−5 ）也会导致轨迹完全偏离。这颠覆了传统“确定性系统必然可预测”的直觉认知。

奇异吸引子的直观感受：3D图中“蝴蝶”结构的无限折叠、非周期轨道，直观理解了吸引子如何通过拉伸与折叠产生混沌。

2. 数值模拟的实践启示

精度与算法的权衡：使用RK45与Euler方法的对比说明，混沌系统必须选择高精度自适应算法，否则误差会指数级放大（如Euler法在t>20后完全失真）。

容差的重要性：通过调整rtol和atol，发现宽松容差（如1e-3）会导致虚假的“稳定轨道”，而严格容差（1e-6）才能还原真实混沌行为。

3. 科学可视化的重要性

3D轨迹图的直观性：将抽象的微分方程解转化为“蝴蝶”形状的吸引子，帮助我理解混沌系统的空间结构。

对比图的动态分离：x(t)曲线从重合到分叉的过程，生动展示了“蝴蝶效应”的时间尺度。

4. 跨学科应用的思考

气象学的启示：洛伦兹系统最初用于简化大气对流模型，说明了为何天气预测难以超过两周（混沌系统的初值敏感性）。

工程与金融的通用性：类似特性也存在于电路振荡、种群动力学甚至股票市场，提示我在其他领域建模时需考虑混沌可能性。

5. 对科学研究的反思

模型简化的力量：仅用三个方程就能揭示复杂现象，说明合理简化是科学研究的关键。

数值实验的局限性：即使最优方法也无法长期预测混沌系统，这提醒我：在数据驱动研究中，需明确模型的适用边界。

---

## 5. 附录：核心代码片段

```python
def lorenz_system(state: np.ndarray, sigma: float, r: float, b: float) -> np.ndarray:
    x, y, z = state
    return np.array([
        sigma * (y - x),
        r * x - y - x * z,
        x * y - b * z
    ])


def solve_lorenz_equations(sigma: float=10.0, r: float=28.0, b: float=8/3,
                          x0: float=0.1, y0: float=0.1, z0: float=0.1,
                          t_span: tuple[float, float]=(0, 50), dt: float=0.01):
    """
    求解洛伦兹方程
    """
    t_eval = np.arange(t_span[0], t_span[1], dt)
    sol = solve_ivp(lambda t, state: lorenz_system(state, sigma, r, b), 
                   t_span, [x0, y0, z0], t_eval=t_eval, method='RK45')
    return sol.t, sol.y


def plot_lorenz_attractor(t: np.ndarray, y: np.ndarray):
    """
    绘制洛伦兹吸引子
    """
    fig = plt.figure(figsize=(12, 8))
    ax = fig.add_subplot(111, projection='3d')
    ax.plot(y[0], y[1], y[2], lw=0.5)
    ax.set_xlabel('X')
    ax.set_ylabel('Y')
    ax.set_zlabel('Z')
    ax.set_title('Lorenz Attractor')
    plt.show()


def compare_initial_conditions(ic1: tuple[float, float, float], 
                              ic2: tuple[float, float, float], 
                              t_span: tuple[float, float]=(0, 50), dt: float=0.01):
    """
    比较不同初始条件的解
    """
    t1, y1 = solve_lorenz_equations(x0=ic1[0], y0=ic1[1], z0=ic1[2], t_span=t_span, dt=dt)
    t2, y2 = solve_lorenz_equations(x0=ic2[0], y0=ic2[1], z0=ic2[2], t_span=t_span, dt=dt)
    
    # 计算轨迹距离
    distance = np.sqrt((y1[0]-y2[0])**2 + (y1[1]-y2[1])**2 + (y1[2]-y2[2])**2)
    
    # 绘制比较图
    plt.figure(figsize=(12, 6))
    plt.plot(t1, y1[0], label=f'IC1: {ic1}')
    plt.plot(t2, y2[0], label=f'IC2: {ic2}')
    plt.xlabel('Time')
    plt.ylabel('X')
    plt.title('Comparison of X(t) with Different Initial Conditions')
    plt.legend()
    plt.show()
    
    plt.figure(figsize=(12, 6))
    plt.plot(t1, distance, label='Distance between trajectories')
    plt.xlabel('Time')
    plt.ylabel('Distance')
    plt.title('Distance between Trajectories over Time')
    plt.legend()
    plt.show()
```
